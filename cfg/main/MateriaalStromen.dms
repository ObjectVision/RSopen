container MateriaalStromen : using = "Classifications"
{
	container NaarCMLLeiden
	{
		unit<uint32> WP4xEnergielabel        := Vastgoed/WP4/xEnergielabel;
		unit<uint32> pand_src_domain         := SourceData/Vastgoed/BAG/PerJaar/Y2021/Panden/src;
		unit<uint32> pand_domain             := SourceData/Vastgoed/BAG/PerJaar/Y2021/Panden/pand;
		
		parameter<string> Generate_All := 'Ready', ExplicitSuppliers = "Stand2021/Generate;Y2021_Y2030/Generate;Y2030_Y2040/Generate;Y2040_Y2050/Generate";
		
		container Stand2021
		{
			parameter<string> Generate := 'Ready', ExplicitSuppliers = "Opp_perWP4xEL;Aantal_perWP4xEL;AvgBouwjaar_perWP4";
			
			container Opp_perWP4xEL := 
					for_each_nedva(
						WP4xEnergielabel/label
						, 	'sum(
									recollect_by_cond(
										pand_src_domain/Pand_selection_condition
										, Pand_domain/VBOopp_inPand_perWP4xEnergielabel/'+WP4xEnergielabel/WP4_name+'/'+WP4xEnergielabel/Energielabel_name+'
										, 0[meter2]
									)[pand_src_domain/ToedelingsMatrix/pand_rel] 
									* pand_src_domain/ToedelingsMatrix/ToedelingPand
								, pand_src_domain/ToedelingsMatrix/AdminDomain_rel)'
						, AdminDomain
						, meter2
						, '%LocalDataProjDir%/Export/NaarCMLLeiden/Stand_Y2021_Opp_'+WP4xEnergielabel/label+'_25m.tif'
					);
					
			container Aantal_perWP4xEL := 
					for_each_nedva(
						WP4xEnergielabel/label
						, 	'sum(
									recollect_by_cond(
										pand_src_domain/Pand_selection_condition
										, Pand_domain/Count_inPand_perWP4xEnergielabel/'+WP4xEnergielabel/WP4_name+'/'+WP4xEnergielabel/Energielabel_name+'
										, 0[Woning]
									)[pand_src_domain/ToedelingsMatrix/pand_rel] 
									* pand_src_domain/ToedelingsMatrix/ToedelingPand
								, pand_src_domain/ToedelingsMatrix/AdminDomain_rel)'
						, AdminDomain
						, Woning
						, '%LocalDataProjDir%/Export/NaarCMLLeiden/Stand_Y2021_Aantal_'+WP4xEnergielabel/label+'_25m.tif'
					);
					
			container AvgBouwjaar_perWP4 := 
					for_each_nedva(
						Vastgoed/WP4/name
						, 	'uint16(
								sum(
										recollect_by_cond(
											pand_src_domain/Pand_selection_condition
											, Pand_domain/WP4_rel == Vastgoed/WP4/V/'+Vastgoed/WP4/name+' 
												? float32(Pand_domain/bouwjaar_trunc) * Pand_domain/VBOopp_inPand_perWP4/'+Vastgoed/WP4/name+' / 1[meter2] 
												: 0f/0f
											, 0f/0f
										)[pand_src_domain/ToedelingsMatrix/pand_rel] 
										* pand_src_domain/ToedelingsMatrix/ToedelingPand
									, pand_src_domain/ToedelingsMatrix/AdminDomain_rel)
								/ 
								sum(
										recollect_by_cond(
											pand_src_domain/Pand_selection_condition
											, Pand_domain/VBOopp_inPand_perWP4/'+Vastgoed/WP4/name+' / 1[meter2] 
											, 0f/0f
										)[pand_src_domain/ToedelingsMatrix/pand_rel] 
										* pand_src_domain/ToedelingsMatrix/ToedelingPand
									, pand_src_domain/ToedelingsMatrix/AdminDomain_rel))'
						, AdminDomain
						, uint16
						, '%LocalDataProjDir%/Export/NaarCMLLeiden/Stand_Y2021_AvgBouwjaar_'+Vastgoed/WP4/name+'_25m.tif'
					);
		}
		
		container Y2021_Y2030 
		{
			parameter<string> Generate := 'Ready', ExplicitSuppliers = "Opp_Nieuwbouw_perWP4;Opp_Sloop_perWP4;Aantal_Nieuwbouw_perWP4;Aantal_Sloop_perWP4";
			
			container Opp_Nieuwbouw_perWP4 := 
				for_each_nedva(
					Vastgoed/WP4/name
					, 'Indicatoren/Y2030/SloopNieuwbouwWonen/InclBAG/Nieuwbouw_opp/'+Vastgoed/WP4/name
					, AdminDomain
					, Meter2
					, '%LocalDataProjDir%/Export/NaarCMLLeiden/Verandering_Y2021_Y2030_Nieuwbouw_opp_'+Vastgoed/WP4/name+'_25m.tif'
				);
			container Opp_Sloop_perWP4 := 
				for_each_nedva(
					Vastgoed/WP4/name
					, 'Indicatoren/Y2030/SloopNieuwbouwWonen/InclBAG/Sloop_opp/'+Vastgoed/WP4/name
					, AdminDomain
					, Meter2
					, '%LocalDataProjDir%/Export/NaarCMLLeiden/Verandering_Y2021_Y2030_Sloop_opp_'+Vastgoed/WP4/name+'_25m.tif'
				);
				
			container Aantal_Nieuwbouw_perWP4 := 
				for_each_nedva(
					Vastgoed/WP4/name
					, 'Indicatoren/Y2030/SloopNieuwbouwWonen/InclBAG/Nieuwbouw/'+Vastgoed/WP4/name
					, AdminDomain
					, Woning
					, '%LocalDataProjDir%/Export/NaarCMLLeiden/Verandering_Y2021_Y2030_Nieuwbouw_aantal_'+Vastgoed/WP4/name+'_25m.tif'
				);
			container Aantal_Sloop_perWP4 := 
				for_each_nedva(
					Vastgoed/WP4/name
					, 'Indicatoren/Y2030/SloopNieuwbouwWonen/InclBAG/Sloop/'+Vastgoed/WP4/name
					, AdminDomain
					, Woning
					, '%LocalDataProjDir%/Export/NaarCMLLeiden/Verandering_Y2021_Y2030_Sloop_aantal_'+Vastgoed/WP4/name+'_25m.tif'
				);
		}
		
		container Y2030_Y2040
		{
			parameter<string> Generate := 'Ready', ExplicitSuppliers = "Opp_Nieuwbouw_perWP4;Opp_Sloop_perWP4;Aantal_Nieuwbouw_perWP4;Aantal_Sloop_perWP4";
			
			container Opp_Nieuwbouw_perWP4 := 
				for_each_nedva(
					Vastgoed/WP4/name
					, 'Indicatoren/Y2040/SloopNieuwbouwWonen/Nieuwbouw_opp/'+Vastgoed/WP4/name
					, AdminDomain
					, Meter2
					, '%LocalDataProjDir%/Export/NaarCMLLeiden/Verandering_Y2030_Y2040_Nieuwbouw_opp_'+Vastgoed/WP4/name+'_25m.tif'
				);
			container Opp_Sloop_perWP4 := 
				for_each_nedva(
					Vastgoed/WP4/name
					, 'Indicatoren/Y2040/SloopNieuwbouwWonen/Sloop_opp/'+Vastgoed/WP4/name
					, AdminDomain
					, Meter2
					, '%LocalDataProjDir%/Export/NaarCMLLeiden/Verandering_Y2030_Y2040_Sloop_opp_'+Vastgoed/WP4/name+'_25m.tif'
				);
				
			container Aantal_Nieuwbouw_perWP4 := 
				for_each_nedva(
					Vastgoed/WP4/name
					, 'Indicatoren/Y2040/SloopNieuwbouwWonen/Nieuwbouw/'+Vastgoed/WP4/name
					, AdminDomain
					, Woning
					, '%LocalDataProjDir%/Export/NaarCMLLeiden/Verandering_Y2030_Y2040_Nieuwbouw_aantal_'+Vastgoed/WP4/name+'_25m.tif'
				);
			container Aantal_Sloop_perWP4 := 
				for_each_nedva(
					Vastgoed/WP4/name
					, 'Indicatoren/Y2040/SloopNieuwbouwWonen/Sloop/'+Vastgoed/WP4/name
					, AdminDomain
					, Woning
					, '%LocalDataProjDir%/Export/NaarCMLLeiden/Verandering_Y2030_Y2040_Sloop_aantal_'+Vastgoed/WP4/name+'_25m.tif'
				);
		}
		container Y2040_Y2050
		{
			parameter<string> Generate := 'Ready', ExplicitSuppliers = "Opp_Nieuwbouw_perWP4;Opp_Sloop_perWP4;Aantal_Nieuwbouw_perWP4;Aantal_Sloop_perWP4";
			
			container Opp_Nieuwbouw_perWP4 := 
				for_each_nedva(
					Vastgoed/WP4/name
					, 'Indicatoren/Y2050/SloopNieuwbouwWonen/Nieuwbouw_opp/'+Vastgoed/WP4/name
					, AdminDomain
					, Meter2
					, '%LocalDataProjDir%/Export/NaarCMLLeiden/Verandering_Y2040_Y2050_Nieuwbouw_opp_'+Vastgoed/WP4/name+'_25m.tif'
				);
			container Opp_Sloop_perWP4 := 
				for_each_nedva(
					Vastgoed/WP4/name
					, 'Indicatoren/Y2050/SloopNieuwbouwWonen/Sloop_opp/'+Vastgoed/WP4/name
					, AdminDomain
					, Meter2
					, '%LocalDataProjDir%/Export/NaarCMLLeiden/Verandering_Y2040_Y2050_Sloop_opp_'+Vastgoed/WP4/name+'_25m.tif'
				);
				
			container Aantal_Nieuwbouw_perWP4 := 
				for_each_nedva(
					Vastgoed/WP4/name
					, 'Indicatoren/Y2050/SloopNieuwbouwWonen/Nieuwbouw/'+Vastgoed/WP4/name
					, AdminDomain
					, Woning
					, '%LocalDataProjDir%/Export/NaarCMLLeiden/Verandering_Y2040_Y2050_Nieuwbouw_aantal_'+Vastgoed/WP4/name+'_25m.tif'
				);
			container Aantal_Sloop_perWP4 := 
				for_each_nedva(
					Vastgoed/WP4/name
					, 'Indicatoren/Y2050/SloopNieuwbouwWonen/Sloop/'+Vastgoed/WP4/name
					, AdminDomain
					, Woning
					, '%LocalDataProjDir%/Export/NaarCMLLeiden/Verandering_Y2040_Y2050_Sloop_aantal_'+Vastgoed/WP4/name+'_25m.tif'
				);
		}
	}
}