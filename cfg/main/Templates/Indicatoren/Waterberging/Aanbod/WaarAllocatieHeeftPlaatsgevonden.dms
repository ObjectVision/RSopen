container WaarAllocatieHeeftPlaatsgevonden
{
	container Wonen
	{
		attribute<Bool> AllocatieHeeftPlaatsgevonden (AdminDomain) := IsDefined(Stand/OP_rel);
		
		container OpDaken
		{
			parameter<float32> FractieGroenDak := /VariantParameters/VariantK/FractieGroenDakNieuwbouw[/Variant_rel];
			
			attribute<meter2> Dakoppervlak      (AdminDomain) := VariantParameters/Ontwikkelpakketten/DezeBuurtSchaal/Default/InDezeBuurt/Terreinoppervlakte/Totaal/GebouwVoetafdruk[Stand/OP_rel] * AdminDomain/NrHaPerCell[float32];
			attribute<meter2> DakoppervlakGroen (AdminDomain) := Dakoppervlak * FractieGroenDak;
			attribute<meter3> Resultaat         (AdminDomain) := DakoppervlakGroen * Classifications/WaterretentieK/Bergingscapaciteit[Classifications/WaterretentieK/V/GroenDak];
		}
		
		container OpOverigVerhardUitgeefbaar
		{
			parameter<float32> FractieHalfverharding := /VariantParameters/VariantK/FractieHalfverhardingNieuwbouwUitgeefbaar[/Variant_rel];
			
			attribute<meter2> VerhardOppervlak      (AdminDomain) := VariantParameters/Ontwikkelpakketten/DezeBuurtSchaal/Default/InDezeBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Verhard[Stand/OP_rel] * AdminDomain/NrHaPerCell[float32];
			attribute<meter2> VerhardOppervlakGroen (AdminDomain) := VerhardOppervlak * FractieHalfverharding;
			attribute<meter3> Resultaat             (AdminDomain) := VerhardOppervlakGroen * Classifications/WaterretentieK/Bergingscapaciteit[Classifications/WaterretentieK/V/Halfverharding];
		}
		
		container OpVerhardOpenbaar
		{
			parameter<float32> FractieHalfverharding := /VariantParameters/VariantK/FractieHalfverhardingNieuwbouwOpenbaar[/Variant_rel];
			
			attribute<meter2> VerhardOppervlak      (AdminDomain) := VariantParameters/Ontwikkelpakketten/DezeBuurtSchaal/Default/InDezeBuurt/Terreinoppervlakte/Openbaar/Verhard[Stand/OP_rel] * AdminDomain/NrHaPerCell[float32];
			attribute<meter2> VerhardOppervlakGroen (AdminDomain) := VerhardOppervlak * FractieHalfverharding;
			attribute<meter3> Resultaat             (AdminDomain) := VerhardOppervlakGroen * Classifications/WaterretentieK/Bergingscapaciteit[Classifications/WaterretentieK/V/Halfverharding];
		}
		
		container OpGrasUitgeefbaar
		{
			parameter<float32> FractieWadi := /VariantParameters/VariantK/FractieWadiNieuwbouwUitgeefbaarGras[/Variant_rel];
			
			attribute<meter2> GrasOppervlak     (AdminDomain) := VariantParameters/Ontwikkelpakketten/DezeBuurtSchaal/Default/InDezeBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen/Gras[Stand/OP_rel] * AdminDomain/NrHaPerCell[float32];
			attribute<meter2> GrasOppervlakWadi (AdminDomain) := GrasOppervlak * FractieWadi;
			attribute<meter3> Resultaat         (AdminDomain) := GrasOppervlakWadi * Classifications/WaterretentieK/Bergingscapaciteit[Classifications/WaterretentieK/V/Wadi];
		}
		
		container OpGrasOpenbaar
		{
			parameter<float32> FractieWadi := /VariantParameters/VariantK/FractieWadiNieuwbouwOpenbaarGras[/Variant_rel];
			
			attribute<meter2> GrasOppervlak     (AdminDomain) := VariantParameters/Ontwikkelpakketten/DezeBuurtSchaal/Default/InDezeBuurt/Terreinoppervlakte/Openbaar/Groen/Gras[Stand/OP_rel] * AdminDomain/NrHaPerCell[float32];
			attribute<meter2> GrasOppervlakWadi (AdminDomain) := GrasOppervlak * FractieWadi;
			attribute<meter3> Resultaat         (AdminDomain) := GrasOppervlakWadi * Classifications/WaterretentieK/Bergingscapaciteit[Classifications/WaterretentieK/V/Wadi];
		}
		
		attribute<meter3> Totaal (AdminDomain) := OpDaken/Resultaat + OpOverigVerhardUitgeefbaar/Resultaat + OpVerhardOpenbaar/Resultaat + OpGrasUitgeefbaar/Resultaat/ + OpGrasOpenbaar/Resultaat;
	}
	
	container Werken := WerkenEnVerblijfsrecreatie('Werken');
	container Verblijfsrecreatie := WerkenEnVerblijfsrecreatie('Verblijfsrecreatie');
	
	attribute<meter3> Totaal (AdminDomain) := add(MakeDefined(Wonen/Totaal, 0[meter3]), MakeDefined(Werken/Totaal, 0[meter3]), MakeDefined(Verblijfsrecreatie/Totaal, 0[meter3])); 
	
	Template WerkenEnVerblijfsrecreatie
	{
		//
		parameter<string> Sector_ref;
		//
		
		attribute<Bool> AllocatieHeeftPlaatsgevonden (AdminDomain) := = 'Stand/Sector_rel == /Classifications/Actor/Sector/V/'+Sector_ref;
	
		parameter<float32> FractieUitgeefbaar := = 'ModelParameters/'+Sector_ref+'/FractieUitgeefbaar', Descr = "De fractie van de terreinoppervlakte die uitgeefbaar wordt gemaakt";
		parameter<float32> FractieGrasInGroen := = 'VariantParameters/FractiesGroenIn'+Sector_ref+'/DezeVariant/FractieGrasInGroen';
		
		attribute<meter2> StandPandFootprintWaarAllocHeeftPlaatsgevonden0 (AdminDomain) := = 'Stand/PandFootprint_'+Sector_ref+' / float32(AllocatieHeeftPlaatsgevonden)';  //@Jip, waarom is deze waarde soms groter dan NoHapercell?
		attribute<meter2> StandPandFootprintWaarAllocHeeftPlaatsgevonden  (AdminDomain) := min_elem(AdminDomain/NrHaPerCell[meter2], StandPandFootprintWaarAllocHeeftPlaatsgevonden0) / float32(AllocatieHeeftPlaatsgevonden);
		
		container OpDaken
		{
			parameter<float32> FractieGroenDak := /VariantParameters/VariantK/FractieGroenDakNieuwbouw[/Variant_rel];
			
			attribute<meter2> Dakoppervlak      (AdminDomain) := StandPandFootprintWaarAllocHeeftPlaatsgevonden;
			attribute<meter2> DakoppervlakGroen (AdminDomain) := Dakoppervlak * FractieGroenDak;
			attribute<meter3> Resultaat         (AdminDomain) := DakoppervlakGroen * Classifications/WaterretentieK/Bergingscapaciteit[Classifications/WaterretentieK/V/GroenDak];
		}
		
		container OpOverigVerhardUitgeefbaar
		{
			parameter<float32> FractieHalfverharding := /VariantParameters/VariantK/FractieHalfverhardingNieuwbouwUitgeefbaar[/Variant_rel];
			
			attribute<meter2> VerhardOppervlak      (AdminDomain) := = '(AdminDomain/NrHaPerCell[meter2] - StandPandFootprintWaarAllocHeeftPlaatsgevonden) * VariantParameters/FractiesGroenIn'+Sector_ref+'/DezeVariant/Verhard * FractieUitgeefbaar';
			attribute<meter2> VerhardOppervlakGroen (AdminDomain) := VerhardOppervlak * FractieHalfverharding;
			attribute<meter3> Resultaat             (AdminDomain) := VerhardOppervlakGroen * Classifications/WaterretentieK/Bergingscapaciteit[Classifications/WaterretentieK/V/Halfverharding];
		}
		
		container OpVerhardOpenbaar
		{
			parameter<float32> FractieHalfverharding := /VariantParameters/VariantK/FractieHalfverhardingNieuwbouwOpenbaar[/Variant_rel];
			
			attribute<meter2> VerhardOppervlak      (AdminDomain) := = '(AdminDomain/NrHaPerCell[meter2] - StandPandFootprintWaarAllocHeeftPlaatsgevonden) * VariantParameters/FractiesGroenIn'+Sector_ref+'/DezeVariant/Verhard * (1f - FractieUitgeefbaar)';
			attribute<meter2> VerhardOppervlakGroen (AdminDomain) := VerhardOppervlak * FractieHalfverharding;
			attribute<meter3> Resultaat             (AdminDomain) := VerhardOppervlakGroen * Classifications/WaterretentieK/Bergingscapaciteit[Classifications/WaterretentieK/V/Halfverharding];
		}
		
		container OpGrasUitgeefbaar
		{
			parameter<float32> FractieWadi := /VariantParameters/VariantK/FractieWadiNieuwbouwUitgeefbaarGras[/Variant_rel];
			
			attribute<meter2> GrasOppervlak     (AdminDomain) := = 'FractieGrasInGroen * (AdminDomain/NrHaPerCell[meter2] - Verharding/'+Sector_ref+'/Verhard) * FractieUitgeefbaar';
			attribute<meter2> GrasOppervlakWadi (AdminDomain) := GrasOppervlak * FractieWadi;
			attribute<meter3> Resultaat         (AdminDomain) := GrasOppervlakWadi * Classifications/WaterretentieK/Bergingscapaciteit[Classifications/WaterretentieK/V/Wadi];
		}
		
		container OpGrasOpenbaar
		{
			parameter<float32> FractieWadi := /VariantParameters/VariantK/FractieWadiNieuwbouwOpenbaarGras[/Variant_rel];
			
			attribute<meter2> GrasOppervlak     (AdminDomain) := = 'FractieGrasInGroen * (AdminDomain/NrHaPerCell[meter2] - Verharding/'+Sector_ref+'/Verhard) * (1f - FractieUitgeefbaar)';
			attribute<meter2> GrasOppervlakWadi (AdminDomain) := GrasOppervlak * FractieWadi;
			attribute<meter3> Resultaat         (AdminDomain) := GrasOppervlakWadi * Classifications/WaterretentieK/Bergingscapaciteit[Classifications/WaterretentieK/V/Wadi];
		}
		
		attribute<meter3> Totaal (AdminDomain) := OpDaken/Resultaat + OpOverigVerhardUitgeefbaar/Resultaat + OpVerhardOpenbaar/Resultaat + OpGrasUitgeefbaar/Resultaat + OpGrasOpenbaar/Resultaat;
	}
}