container Aanbod
{
	#include<WaarAllocatieHeeftPlaatsgevonden.dms>
	
	container WaarGeenAllocatieHeeftPlaatsgevonden
	{
		attribute<Bool> AllocatieHeeftNietPlaatsgevonden (AdminDomain) := !IsDefined(Stand/Sector_rel);
		
		container OpDaken
		{
			parameter<float32> FractieGroenDak := /VariantParameters/VariantK/FractieGroenDakBestaandeBouwIn2050[/Variant_rel];
			
			attribute<meter2> Dakoppervlak      (AdminDomain) :=  Basisjaar/Stand/PandFootprint_Wonen + Basisjaar/Stand/PandFootprint_Werken + Basisjaar/Stand/PandFootprint_Verblijfsrecreatie / float32(AllocatieHeeftNietPlaatsgevonden);
			attribute<meter2> DakoppervlakGroen (AdminDomain) := Dakoppervlak * FractieGroenDak;
			attribute<meter3> Resultaat         (AdminDomain) := DakoppervlakGroen * Classifications/WaterretentieK/Bergingscapaciteit[Classifications/WaterretentieK/V/GroenDak];
		}
		
		container OpOverigePlekken
		{
			container GrondgebruikSrc := /SourceData/Grondgebruik/BGT/IsDefinedAndNotNoData;
			
			parameter<string> CalcString := 'GrondgebruikSrc/@Capaciteit_AdminDomain * /VariantParameters/VariantK/FractieWaterretentieCapaciteit@[/Variant_rel] * Classifications/WaterretentieK/MetBenodigdeVelddata/Bergingscapaciteit[Classifications/WaterretentieK/MetBenodigdeVelddata/V/@] / float32(AllocatieHeeftNietPlaatsgevonden)';
			
			container PerWaterrententieK := for_each_nedv(Classifications/WaterretentieK/MetBenodigdeVelddata/name, replace(CalcString, '@', Classifications/WaterretentieK/MetBenodigdeVelddata/name), AdminDomain, meter3);
			
			attribute<meter3> Totaal (AdminDomain) := = 'add('+AsItemList('PerWaterrententieK/'+Classifications/WaterretentieK/MetBenodigdeVelddata/name)+')';
		}
		
		attribute<meter3> Totaal (AdminDomain) := OpDaken/Resultaat + OpOverigePlekken/Totaal;
	}
	
	attribute<meter3> Totaal (AdminDomain) := MakeDefined(WaarAllocatieHeeftPlaatsgevonden/Totaal, WaarGeenAllocatieHeeftPlaatsgevonden/Totaal);
}