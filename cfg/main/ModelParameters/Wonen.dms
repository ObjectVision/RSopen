////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Dit is RSOpen, de open source versie van het model RuimteScanner. Het scipt wordt uitgegeven onder GNU-GPL licentie.
//
// RSOpen is ontwikkeld door PBL Planbureau voor de Leefomgeving, i.s.m Object Vision B.V. en VU Vrije Universiteit Amsterdam.
// Opdrachtgever/ontwikkelaar PBL: Bart Rijken
// Contactpersoon/ontwikkelaar Object Vision B.V.: Jip Claassens (jclaassens@objectvision.nl)
// Contacpersoon PBL: Bas van Bemmel (Bas.vanBemmel@pbl.nl)
//
// Deze file specificeert de ModelParameters: Parameters die voor elk scenario en elke Variant hetzelfde zijn.
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

container Wonen
{
	parameter<Yr>        GeenSlooptotLeeftijd_BinnenHardePlancapaciteit      := 25[Yr], Descr = "Geen sloop toegestaan van woningen met een leeftijd jonger dan opgegeven.";
	parameter<String>    Suitability_ref                                     := 'ExploitatieSaldo', Descr = "Grondslag voor de empirische onderbouwing van de geschiktheid van ontwikkelpakketten binnen de sector Wonen: ExploitatieSaldo, ResidueleWaarde";
	parameter<String>    grondproductie_kosten_Variant                       := 'Nominaal_high', Descr = "Variant binnen een bandbreedte  t.a.v. onzekerheid qua: 1) standaardfout (statistische onzekerheid), en; 2) keuzeopties tav de controlevariabelen (referentie of niet)";
	parameter<Float32>   PrijsIndex_Bouwkosten_2017_naar_2022                := 1.23f, Descr = "Voor 2022 met 2017==100 -> 1.23; voor 2023 met 2017=100 -> 1.29", URL = "https://opendata.cbs.nl/#/CBS/nl/dataset/83887NED/table";
	parameter<Float32>   PrijsIndex_Bouwkosten_2017_naar_2023                := 1.29f, Descr = "Voor 2022 met 2017==100 -> 1.23; voor 2023 met 2017=100 -> 1.29", URL = "https://opendata.cbs.nl/#/CBS/nl/dataset/83887NED/table";
	
	parameter<float32>   WoningPrijsVerandering_2022_naar_2023               := 0.971f, Descr = "Jaarlijkse groei van 2022 op 2023, obv gemiddelde woningverkoop. Bron CBS Statline.";
	parameter<float32>   WoningPrijsVerandering_2023_naar_2023               := 1f, Descr = "Jaarlijkse groei van 2022 op 2023, obv gemiddelde woningverkoop. Bron CBS Statline.";
	
	container Sloopkosten
	: Descr = "Kentallen van www.bouwkostenkompas.nl"
	{
		parameter<Eur_m2>  Rijtjeswoning_2017    := 22[Eur_m2];
		parameter<Eur_m2>  Twee_onder_1_kap_2017 := 40[Eur_m2];
		parameter<Eur_m2>  Vrijstaand_2017       := 57[Eur_m2];
		parameter<Eur_m2>  Appartement_2017      := 22[Eur_m2];
		parameter<Eur_m2>  Kantoor_2017          := 25[Eur_m2];
		parameter<Eur_m2>  rijtjeswoning         := ='Rijtjeswoning_2017 * PrijsIndex_Bouwkosten_2017_naar_'+string(ModelParameters/Model_StartYear);
		parameter<Eur_m2>  twee_onder_1_kap      := ='Twee_onder_1_kap_2017 * PrijsIndex_Bouwkosten_2017_naar_'+string(ModelParameters/Model_StartYear);
		parameter<Eur_m2>  vrijstaand            := ='Vrijstaand_2017 * PrijsIndex_Bouwkosten_2017_naar_'+string(ModelParameters/Model_StartYear);
		parameter<Eur_m2>  appartement           := ='Appartement_2017 * PrijsIndex_Bouwkosten_2017_naar_'+string(ModelParameters/Model_StartYear);
		parameter<Eur_m2>  kantoor               := ='Kantoor_2017 * PrijsIndex_Bouwkosten_2017_naar_'+string(ModelParameters/Model_StartYear);
	}

	unit<UInt32> Bouwkosten := ='SourceData/RegioIndelingen/CBS/Y'+string(ModelParameters/Model_StartYear)+'/gpkg/landsdeel_gegeneraliseerd'
	, Descr = "Kentallen van CBS, uitgelezen september 2025. Oppervlaktes zijn BVO!"
	, URL = "https://opendata.cbs.nl/#/CBS/nl/dataset/83673NED/table?dl=C651A" 
	{
		attribute<String> Landsdeel_naam     : ['Noord','Oost','West','Zuid'];
		attribute<String> label              := statnaam;
		attribute<Eur_m2> Huurwoningen_2022  : [ 945, 1029, 1108, 1021];
		attribute<Eur_m2> Huurwoningen_2023  : [1220, 1190, 1379, 1108];
		attribute<Eur_m2> Huurwoningen_2024  : [1273, 1293, 1497, 1224];
		
		attribute<Eur_m2> Koopwoningen_2022  : [ 995,  995, 1054,  969];
		attribute<Eur_m2> Koopwoningen_2023  : [1193, 1100, 1233, 1089];
		attribute<Eur_m2> Koopwoningen_2024  : [1216, 1124, 1292, 1081];
		
		attribute<Eur_m2> Huurwoningen       := ='Huurwoningen_'+string(ModelParameters/Model_StartYear);
		attribute<Eur_m2> Koopwoningen       := ='Koopwoningen_'+string(ModelParameters/Model_StartYear), IntegrityCheck = "All(Landsdeel_naam+'-Nederland' == statnaam)", Descr = "Check om ervoor te zorgen dat de volgorde deze handmatig opgegeven waardes matches met de volgorde van de regios.";
		
		attribute<.>      Per_AllocDomain (AllocDomain) := poly2grid(geometry, AllocDomain);
		attribute<.>      Per_AdminDomain (AdminDomain) := Per_AllocDomain[AdminDomain/AllocDomain_rel];

		attribute<Eur_m2> SocialeHuur (AdminDomain) := Huurwoningen[Per_AdminDomain];
		attribute<Eur_m2> VrijeSector (AdminDomain) := Koopwoningen[Per_AdminDomain];
	}
	
	container Verwervingskosten
	: Descr = "In de bepaling van de Verwervingskosten zijn woningen middels een hedonische prijsanalyse bepaald. Voor nieuw-woningen is dit lastiger (o.a. vanwege de heterogeniteit van commercieel vastgoed), daarom is er een hoge waarde van 10,000 euro per m2 gekozen."
	{
		parameter<Eur_m2> NietWoningen := ='10000[eur_m2] * PrijsIndex_Bouwkosten_2017_naar_'+string(ModelParameters/Model_StartYear);
	}
	
	parameter<meter>               Hoogbouwgrens                := 15[meter], Descr = "De hoogte van een woongebouw vanaf waar we het hoogbouw noemen. Bron: expert judgement PBL"; 
	parameter<meter>               Bouwlaaghoogte               := 2.6[meter], Descr = "Aanname voor de hoogte van een bouwlaag. Onder andere nodig om bij benadering het aantal verdiepingen per gebouw te kunnen schatten. Bron: expert judgement PBL";
	parameter<Woonoppervlak_m2BVO> VormfactorEengezins          := 0.76[Woonoppervlak_m2BVO], Descr = "De vormfactor is de verhouding tussen het verhuurbare vloeroppervlak (woonoppervlak in het geval van wonen) van een gebouw en het totale (bruto) vloeroppervlak.";
	parameter<Woonoppervlak_m2BVO> VormfactorMeergezins         := 0.78[Woonoppervlak_m2BVO], Descr = "De vormfactor is de verhouding tussen het verhuurbare vloeroppervlak (woonoppervlak in het geval van wonen) van een gebouw en het totale (bruto) vloeroppervlak.";
	parameter<Woonoppervlak_m2BVO> VormfactorHoogbouw           := 0.65[Woonoppervlak_m2BVO], Descr = "De vormfactor is de verhouding tussen het verhuurbare vloeroppervlak (woonoppervlak in het geval van wonen) van een gebouw en het totale (bruto) vloeroppervlak. Kersten Nabielek (PBL) gaat uit van 0.5. Obv expert judgement PBL gaan er tussenin zitten."; 
	parameter<Float32>             FractieUitgeefbaar           := 0.5f, Descr = "Aandeel van een NettoBuurt dat uitgeefbaar is (= gebouwFootprint plus evt niet gemeentelijke buitenruimte (tuinen etc.)). Bron: expert judgement PBL.";
	parameter<Float32>             FractieUitgeefbaarTinyHouses := 0.25f, Descr = "Aandeel van een NettoBuurt dat uitgeefbaar is (= gebouwFootprint plus evt niet gemeentelijke buitenruimte (tuinen etc.)). Bron: expert judgement PBL.";
	parameter<Float32>             DefaultVerharding            := 0.1f, Descr = "Fractie van het deel van een gridcel dat niet in beslag wordt genomen door gebouwen en dat gebruikt wordt voor verharde wegen, paden, parkeerplaatsen. Voor gebruik op 100x100m resolutie. Bron: expert judgement PBL in overleg met WUR";

	container DefaultFractiesGrasBoomStruikInGroen
	: Descr = "Fractie van het groen in een gridcel dat wordt gebruikt door diverse subTypen groen. Voor gebruik op 100x100m resolutie. Bron: expert judgement PBL in overleg met WUR"
	{
		parameter<Float32> Gras   := 0.4f;
		parameter<Float32> Boom   := 0.4f;
		parameter<Float32> Struik := 0.2f;
	}

	parameter<meter> MaximaleDiepteAangepastBouwen := 1[meter], Descr = "Maximale Overstromingsdiepte voor aangepast bouwen, bijvoorbeeld op terpen. Bron: expert judgement PBL";
	parameter<cm>    MaxBodemdaling                := 40[cm], Descr = "Maximale bodemdaling op slappe/zetytingsgevoelige gronden waarop beheerskosten voor infra 'acceptabel' worden voorondersteld. Bron: expert judgement PBL i.o.m Deltares";
	
	container BAG_woonpand_Typering
	: Descr = "Technische instellingen om de woonpand typering on the fly te kunnen berekenen met de beste performance. Zie afweging in de URL"
	, URL   = "https://github.com/ObjectVision/GeoDMS/issues/816#issuecomment-2426041271"
	{
		parameter<UInt32>  nr_x_tiles         :=  50, Descr = ""; //oude setting 7   
		parameter<UInt32>  nr_y_tiles         :=  50, Descr = ""; //oude setting 13
		parameter<Float64> inflate_size       := 0.2d, Descr = "Inflate van panden in meters om overlap te detecteren (e.g. bepaling rijtjeswoningen)"; 
	}
	
	unit<uint8> MilieuCat := cat_range(1b, 7b)
	, Descr = "Per milieu categorie, zoals bekend voor bedrijventerreinen (e.g. IBIS), wat is de restrictie buffer daaromheen voor wonen."
	{
		attribute<string> Name              := 'Cat'+string(MaxMilieuCat);
		attribute<uint8>  MaxMilieuCat      := id(.);
		attribute<meter>  Buffer_wonen      := 
			switch(
				 case(MaxMilieuCat == v/Cat1, 0[meter])
				,case(MaxMilieuCat == v/Cat2, 100[meter])
				,case(MaxMilieuCat == v/Cat3, 200[meter])
				,case(MaxMilieuCat == v/Cat4, 500[meter])
				,case(MaxMilieuCat == v/Cat5, 750[meter])
				,case(MaxMilieuCat == v/Cat6, 1000[meter])
				,0[meter]
			);
		
		parameter<meter>  Buffer_rond_Nijverheid := ='Buffer_wonen[v/'+Werken/MilieuCatDist_restrictief_anderesectoren_Nijverheid+']';
		parameter<meter>  Buffer_rond_Logistiek  := ='Buffer_wonen[v/'+Werken/MilieuCatDist_restrictief_anderesectoren_Logistiek+']';
		
		container V := for_each_nedv(name, string(id(.))+'[..]', void, .);
	}

}