////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Dit is RSOpen, de open source versie van het model RuimteScanner. Het scipt wordt uitgegeven onder GNU-GPL licentie.
//
// RSOpen is ontwikkeld door PBL Planbureau voor de Leefomgeving, i.s.m Object Vision B.V. en VU Vrije Universiteit Amsterdam.
// Opdrachtgever/ontwikkelaar PBL: Bart Rijken
// Contactpersoon/ontwikkelaar Object Vision B.V.: Jip Claassens (jclaassens@objectvision.nl)
// Contacpersoon PBL: Bas van Bemmel (Bas.vanBemmel@pbl.nl)
//
// Deze file bevat de verschillende analyses/rekenstappen die nodig zijn voor de berekening van de indicatoren
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

container VariantData: using = "Classifications;units;Geography;VariantParameters;Classifications/Actor"
{
	
	container PotentieleState := 
		for_each_ne(
			Time/Zichtjaar/name
			, 'Templates/PotentieleState_T('+quote(Time/Zichtjaar/name)+', Density)'
		), Descr = "De potentiele state bepaalt hoe een cel gevuld zou kunnen woren in de toekomst. Oftewel, met een bepaalde dichtheid, maar ook of het uberhaupt daar mag.";
	
	container Zeef := 
		for_each_ne(
			Time/Zichtjaar/name
			, 'Templates/Beschikbaarheden/Zeef_Zichtjaar_T('+quote(Time/Zichtjaar/name)+', ., Density, Suitability)'
		)
	{
		#include<Zeef_SrcDomain_grid.dms>
	}
	
	container Suitability := 
		for_each_ne(
			Time/Zichtjaar/name
			, 'Templates/Suitabilities/Suitability_Zichtjaar_T('+quote(Time/Zichtjaar/name)+')'
		)
	{
		#include<Geschiktheden.dms>
	}
	
	#include<Dichtheid.dms>
	#include<Trede.dms>
	#include<Plannen.dms>
	
	container StateBasisjaar := 
		for_each_nedvn(
			Classifications/Modellering/Standvar_Prep/path
			, 'collect_by_cond(CompactedAdminDomain, AdminDomain/IsCompactedDomain, BaseData/StartState/StateBasisjaar/State/'+Classifications/Modellering/Standvar_Prep/path+')' 
			, CompactedAdminDomain
			, Classifications/Modellering/Standvar_Prep
			, Classifications/Modellering/Standvar_Prep/unit_name
		)
	{
		//adhoc
		// container Wonen_per_AllocRegio := 
			// for_each_nedv(
				// /Classifications/Vastgoed/WP2xVSSH/name
				// , 'sum(Wonen/'+/Classifications/Vastgoed/WP2xVSSH/name+', /SourceData/RegioIndelingen/NVM/per_CompactedAdminDomain)'
				// , SourceData/RegioIndelingen/NVM
				// , Woning
			// )
		// {
			// attribute<Woning> Totaal (SourceData/RegioIndelingen/NVM) := ='add('+AsItemList(Classifications/Vastgoed/WP2xVSSH/name)+')';
		// }
		// unit<uint32> Wonen_per_Prov := SourceData/RegioIndelingen/Provincie
		// {
			// attribute<Woning> eengezins  := sum(Wonen/eengezins_vrijesector + Wonen/eengezins_socialehuur, /SourceData/RegioIndelingen/Provincie/per_CompactedAdminDomain);
			// attribute<Woning> meergezins := sum(Wonen/meergezins_vrijesector + Wonen/meergezins_socialehuur, /SourceData/RegioIndelingen/Provincie/per_CompactedAdminDomain);
		// }
		
		// container Wonen_per_Prov := 
			// for_each_nedv(
				// /Classifications/Vastgoed/WP2xVSSH/name
				// , 'sum(Wonen/'+/Classifications/Vastgoed/WP2xVSSH/name+', /SourceData/RegioIndelingen/Provincie/per_CompactedAdminDomain)'
				// , SourceData/RegioIndelingen/Provincie
				// , Woning
			// );
		
		// container Werken_per_AllocRegio := 
			// for_each_nedv(
				// /Classifications/Actor/Jobs6/name
				// , 'sum(Werken/'+/Classifications/Actor/Jobs6/name+', /SourceData/RegioIndelingen/NVM/per_CompactedAdminDomain)'
				// , SourceData/RegioIndelingen/NVM
				// , Job
			// )
		// {
			// attribute<Job> Totaal (SourceData/RegioIndelingen/NVM) := ='add('+AsItemList(/Classifications/Actor/Jobs6/name)+')';
		// }
		// container Werken_per_Prov := 
			// for_each_nedv(
				// /Classifications/Actor/Jobs6/name
				// , 'sum(Werken/'+/Classifications/Actor/Jobs6/name+', /SourceData/RegioIndelingen/Provincie/per_CompactedAdminDomain)'
				// , SourceData/RegioIndelingen/Provincie
				// , Job
			// );
	}
	
	#include<Claims.dms>
	#include<Wind_restricties.dms>
	#include<NietBouwen.dms>
	#include<Maatregelen.dms>
	
	container Restricties := 
		for_each_ne(
			Actor/Sector/name
			,'Templates/MaakRestrictieCombinaties_T('+quote(Actor/Sector/name)+')'
		);
	
	
	container Stimuli := 
		for_each_ne(
			Actor/Sector/name
			,'Templates/MaakStimuliCombinaties_T('+quote(Actor/Sector/name)+')'
		);
		
}