unit<UInt8> CBS2020Klasse: NrOfRows = 42
{
	unit<Uint32> Elements := Range(uint32, 0, nrAttr * #CBS2020Klasse), IsHidden = "True"
	{
		attribute<String> Text: [ // @USERINPUT
		//   EK2020,        BrushColor,                                    name,                          ,           ,        ,           ,                  ,   ,   ,              ,                           LU_ModelType
				 '0', 'rgb(128,128,128)', 'Oorspronkelijk NoData',             'Overigen'                 , 'Overigen'          , 'FALSE', 'Overigen',        'Overigen','0','0',       'Groen',    'Groen', '0','Overig',
				'10', 'rgb(115,76,0)',    'Spoorterrein',                        'Infra'                    , 'Overigen'          , 'FALSE', 'Overigen',        'Bebouwd','4','4',        'Rood',     'Groen', '5','Infra',
				'11', 'rgb(204,0,0)',     'Hoofdweg',                          'Infra'                    , 'Overigen'          , 'FALSE', 'Overigen',        'Bebouwd','4','4',        'Rood',     'Groen', '5','Infra',
				'12', 'rgb(109,109,109)', 'Vliegveld',                         'Infra'                    , 'Overigen'          , 'FALSE', 'Overigen',        'Bebouwd','4','4',        'Rood',     'Groen', '5','Infra',
				'13', 'rgb(115,76,50)',   'Metro en sneltram',                 'Infra'                    , 'Overigen'          , 'FALSE', 'Overigen',        'Bebouwd','4','4',        'Rood',     'Groen', '5','Infra',
				// '14', 'rgb(115,76,75)',   'busbaan',                           'Infra'                    , 'Overigen'          , 'FALSE', 'Overigen',        'Bebouwd','4','4',        'Rood',     'Groen', '5','Infra',
				'20', 'rgb(255,102,0)',   'Woonterrein',                        'woongebied'               , 'Wonen'             , 'FALSE', 'Wonen',           'Bebouwd','1','1',        'Rood',     'Groen', '1','Wonen',
				'21', 'rgb(255,153,51)',  'Detailhandel en horeca',            'Detailhandel_en_horeca'   , 'Werken'            , 'FALSE', 'Werken',          'Bebouwd','2','2',        'Rood',     'Paars','11','Werken',
				'22', 'rgb(255,255,153)', 'Openbare voorziening',            'Voorzieningen'            , 'Werken'            , 'FALSE', 'Werken',          'Bebouwd','2','2',        'Rood',     'Paars','10','Werken',
				'23', 'rgb(255,178,102)', 'Sociaal-culturele voorziening',   'Voorzieningen'            , 'Werken'            , 'FALSE', 'Werken',          'Bebouwd','2','2',        'Rood',     'Groen', '8','Werken',
				'24', 'rgb(128,128,128)', 'Bedrijfsterrein',                 'bedrijfsterreinen'        , 'Werken'            , 'FALSE', 'Werken',          'Bebouwd','2','2',        'Rood',     'Paars', '6','Werken',
				'30', 'rgb(153,102,153)', 'Stortplaats',                     'Overigen'                 , 'Overigen'          , 'FALSE', 'Overigen',        'Bebouwd','2','2',        'Rood',     'Groen','14','Overig',
				// '31', 'rgb(153,102,153)', 'wrakkenopslagplaatsen',             'Overigen'                 , 'Overigen'          , 'FALSE', 'Overigen',        'Bebouwd','2','2',        'Rood',     'Groen','14','Overig',
				'32', 'rgb(153,204,102)', 'Begraafplaats',                     'begraafplaats'            , 'Overigen'          , 'FALSE', 'Stedelijk_groen', 'Bebouwd','2','2',        'Rood',     'Groen','12','Overig',
				'33', 'rgb(155,155,255)', 'Delfstofwinplaats',                'Overigen'                 , 'Overigen'          , 'FALSE', 'Overigen',        'Bebouwd','2','2',        'Rood',     'Groen','14','Overig',
				'34', 'rgb(255,211,127)', 'Bouwterrein',                       'Overigen'                 , 'Overigen'          , 'FALSE', 'Overigen',        'Bebouwd','3','3',        'Rood',     'Groen', '7','Overig',
				'35', 'rgb(254,250,194)', 'Semi-verhard overig terrein',        'Infra'                    , 'Overigen'          , 'FALSE', 'Overigen',        'Bebouwd','2','2',        'Rood',     'Groen', '9','Infra',
				'36', 'rgb(255,230,102)', 'Zonnepark',                         'Energie'                  , 'Overigen'          , 'FALSE', 'Overigen',        'Bebouwd','2','2',        'Rood',     'Groen', '9','Zon',
				'40', 'rgb(177,214,0)',   'Stedelijk groen',                   'parken_en_plantsoenen'    , 'Overigen'          , 'FALSE', 'Stedelijk_groen', 'Bebouwd','5','5',        'Rood',     'Groen','12','Overig',
				'41', 'rgb(153,204,0)',   'Sportterrein',                    'sportterreinen'           , 'Overigen'          , 'FALSE', 'Stedelijk_groen', 'Bebouwd','5','5',        'Rood',     'Groen','12','Overig',
				'42', 'rgb(174,151,75)',  'Volkstuin',                       'volkstuinen'              , 'Overigen'          , 'FALSE', 'Stedelijk_groen', 'Bebouwd','5','5',        'Rood',     'Groen','12','Overig',
				'43', 'rgb(204,255,153)', 'Dagrecreatief terrein',          'dagrecreatieve_terreinen' , 'Overigen'          , 'FALSE', 'Stedelijk_groen', 'Bebouwd','2','2',        'Rood',     'Groen', '4','Overig',
				'44', 'rgb(178,255,102)', 'Verblijfsrecreatief terrein',                'Verblijfsrecreatie'       , 'Verblijfsrecreatie', 'FALSE', 'Stedelijk_groen', 'Bebouwd','2','2',        'Rood',     'Groen', '4','Verblijfsrec',
				'50', 'rgb(204,153,153)', 'Glastuinbouw',                      'Overigen'                 , 'Overigen'          , 'FALSE', 'Werken',          'Bebouwd','6','6',        'Groen',    'Groen', '2','Overig',
				'51', 'rgb(233,255,190)', 'Overig agrarisch terrein',         'overige_agrarisch_gebruik', 'Overigen'          , 'FALSE', 'Landelijk_groen', 'Agrarisch','6','7',      'Groen',    'Groen', '2','',
				'52', 'rgb(230,184,135)', 'Akker en meerjarige teelt',         'overige_agrarisch_gebruik', 'Overigen'          , 'FALSE', 'Landelijk_groen', 'Agrarisch','6','7',      'Groen',    'Groen', '2','',
				'53', 'rgb(180,230,150)', 'Agrarisch grasland',                'overige_agrarisch_gebruik', 'Overigen'          , 'FALSE', 'Landelijk_groen', 'Agrarisch','6','7',      'Groen',    'Groen', '2','',
				'60', 'rgb(103,174,0)',   'Bos',                               'Natuur'                   , 'Overigen'          , 'FALSE', 'Landelijk_groen', 'Natuur','7','8',         'Groen',    'Groen', '3','Natuur',
				'61', 'rgb(170,255,220)', 'Open droog natuurlijk terrein',          'Natuur'                   , 'Overigen'          , 'FALSE', 'Landelijk_groen', 'Natuur','7','9',         'Groen',    'Groen', '3','Natuur',
				'62', 'rgb(170,255,220)', 'Open nat natuurlijk terrein',            'Natuur'                   , 'Overigen'          , 'FALSE', 'Landelijk_groen', 'Natuur','7','9',         'Groen',    'Groen', '3','Natuur',
				// '63', 'rgb(170,255,220)', 'natuurlijk_grasland',               'Natuur'                   , 'Overigen'          , 'FALSE', 'Landelijk_groen', 'Natuur','7','9',         'Groen',    'Groen', '3','Natuur',
				// '64', 'rgb(170,255,220)', 'kustduinen',                        'Natuur'                   , 'Overigen'          , 'FALSE', 'Landelijk_groen', 'Natuur','7','9',         'Groen',    'Groen', '3','Natuur',
				'70', 'rgb(153,204,255)', 'IJsselmeer en Markermeer',             'Water'                    , 'Overigen'          , 'TRUE',  'Overigen',        'Water','8','10',         'Groen',    'Groen','13','Water',
				'71', 'rgb(102,178,255)', 'Afgesloten zeearm',                 'Water'                    , 'Overigen'          , 'TRUE',  'Overigen',        'Water','8','10',         'Groen',    'Groen','13','Water',
				'72', 'rgb(153,204,255)', 'Rijn en Maas',                      'Water'                    , 'Overigen'          , 'TRUE',  'Overigen',        'Water','8','10',         'Groen',    'Groen','13','Water',
				'73', 'rgb(102,178,255)', 'Randmeer',                          'Water'                    , 'Overigen'          , 'TRUE',  'Overigen',        'Water','8','10',         'Groen',    'Groen','13','Water',
				'74', 'rgb(153,204,255)', 'Spaarbekken',                      'Water'                    , 'Overigen'          , 'FALSE', 'Overigen',        'Water','8','10',         'Groen',    'Groen','13','Water',
				'75', 'rgb(153,204,255)', 'Recreatief binnenwater', 'Water'                    , 'Overigen'          , 'FALSE', 'Overigen',        'Water','8','10',         'Groen',    'Groen','13','Water',
				'76', 'rgb(153,204,255)', 'Binnenwater voor delfstofwinning', 'Water'                    , 'Overigen'          , 'FALSE', 'Overigen',        'Water','8','10',         'Groen',    'Groen','13','Water',
				'77', 'rgb(153,204,255)', 'Vloei- en slibveld',              'Water'                    , 'Overigen'          , 'FALSE', 'Overigen',        'Water','2','2',          'Groen',    'Groen','13','Water',
				'78', 'rgb(153,204,255)', 'Overig binnenwater',                'Water'                    , 'Overigen'          , 'FALSE', 'Overigen',        'Water','8','10',         'Groen',    'Groen','13','Water',
				'80', 'rgb(153,204,255)', 'Waddenzee Eems en Dollard',            'Water'                    , 'Overigen'          , 'TRUE',  'Overigen',        'Water','9','11',         'Groen',    'Groen','13','Water',
				'81', 'rgb(153,204,255)', 'Oosterschelde',                     'Water'                    , 'Overigen'          , 'TRUE',  'Overigen',        'Water','8','10',         'Groen',    'Groen','13','Water',
				'82', 'rgb(153,204,255)', 'Westerschelde',                     'Water'                    , 'Overigen'          , 'TRUE',  'Overigen',        'Water','8','10',         'Groen',    'Groen','13','Water',
				'83', 'rgb(153,204,255)', 'Noordzee',                          'Water'                    , 'Overigen'          , 'TRUE',  'Overigen',        'Water','9','11',         'Groen',    'Groen','13','Water', 
				 '0', 'rgb(255,255,255)', 'Buitenland',                        'Overigen'                 , 'Overigen'          , 'FALSE', 'Overigen',        'Buitenland','0','',      'Groen',    'Groen', '0','Overig'
		], DialogType = "BrushColor";
	}
	attribute<CBS2020KlasseEK> EK2020                := value(Elements/Text[value(Uint32(id(.))* nrAttr + 0, Elements)], CBS2020KlasseEK);     //[0,10,11,12,20,21,22,23,24,30,31,32,33,34,35,40,41,42,43,44,50,51,60,61,62,70,71,72,73,74,75,76,77,78,80,81,82,83, 0];
	attribute<UInt32>          BrushColor            := ='union_data(., '+asItemList(Elements/Text[value(Uint32(id(.))* nrAttr + 1, Elements)])+')', DialogType = "BrushColor";
	attribute<String>          Label                 := Elements/Text[value(Uint32(id(.))* nrAttr + 2, Elements)];
	attribute<String>          name                  := AsItemName(label);
	attribute<String>          Aggr_ref              := Elements/Text[value(Uint32(id(.))* nrAttr + 3, Elements)];
	attribute<String>          Sector_ref            := Elements/Text[value(Uint32(id(.))* nrAttr + 4, Elements)];
	attribute<Bool>            IsGrootWater          := bool(Elements/Text[value(Uint32(id(.))* nrAttr +  5, Elements)]);
	attribute<String>          Aggr2_ref             := Elements/Text[value(Uint32(id(.))* nrAttr + 6, Elements)];
	// attribute<String>          Aggr3_ref             := Elements/Text[value(Uint32(id(.))* nrAttr + 7, Elements)];

	attribute<gg_10K>           gg_10k_rel            := Elements/Text[value(Uint32(id(.))* nrAttr + 8, Elements)][gg_10K];
	attribute<UInt8>           gg_12k_rel            := Elements/Text[value(Uint32(id(.))* nrAttr + 9, Elements)][uint8];
	// attribute<String>          Aggr4_ref             := Elements/Text[value(Uint32(id(.))* nrAttr + 10, Elements)];
	// attribute<String>          Aggr5_ref             := Elements/Text[value(Uint32(id(.))* nrAttr + 11, Elements)];
	// attribute<gg_RuimtebeslagRapport> gg_RuimtebeslagRapport_rel := Elements/Text[value(Uint32(id(.))* nrAttr + 12, Elements)][uint8];
	attribute<String>          LU_ModelType          := Elements/Text[value(Uint32(id(.))* nrAttr + 13, Elements)];
	attribute<Actor/LU_ModelType> LU_ModelType_rel   := rlookup(lowercase(LU_ModelType), lowercase(Actor/LU_ModelType/Sector_name));
	attribute<Aggr2>           Aggr2_rel             := rlookup(lowercase(Aggr2_ref), lowercase(Aggr2/name));
	// attribute<Aggr3>           Aggr3_rel             := rlookup(Aggr3_ref, Aggr3/name);
	// attribute<Aggr4>           Aggr4_rel             := rlookup(Aggr4_ref, Aggr4/name);
	// attribute<Aggr5>           Aggr5_rel             := rlookup(Aggr5_ref, Aggr5/name);

	attribute<Aggr>            Aggr_rel              := rlookup(lowercase(Aggr_ref), lowercase(Aggr/name));
	attribute<Actor/Sector>    Sector_rel            := rlookup(lowercase(Sector_ref), lowercase(Actor/Sector/name));
	// attribute<Sector>          Sector_rel2           := rlookup(Sector_ref, Sector/name);
	// attribute<Bool>            IsGrootschaligeInfra  := Aggr_rel == Aggr/V/Infra || id(.) == V/afgesloten_zeearm || id(.) == V/Rijn_en_Maas || id(.) == V/Randmeer;
	// attribute<Bool>            TXLUitleglocatie      := Aggr_rel == Aggr/V/Natuur || Aggr_rel == Aggr/V/overige_agrarisch_gebruik || Aggr_rel == Aggr/V/Overigen || Aggr_rel == Aggr/V/Water;
	// attribute<Bool>            TXLInbreidingslocatie := !TXLUitleglocatie;
	attribute<Bool> IsExogeen    := Aggr_rel == Aggr/v/infra ||  Aggr_rel == Aggr/v/begraafplaats;

	attribute<Bool> IsWoonlocatie := id(.) == V/Woonterrein;
	attribute<Bool> IsWerklocatie :=
		id(.) == V/Detailhandel_en_horeca          ||
		id(.) == V/openbare_Voorziening          ||
		id(.) == V/sociaal_culturele_Voorziening ||
		id(.) == V/bedrijfsterrein;
		
	attribute<Bool> IsStedelijkBreed := IsWoonlocatie || IsWerklocatie || id(.) == V/Vliegveld;
	
	// attribute<Bool> IsStedelijk := IsWoonlocatie || IsWerklocatie;
	// attribute<Bool> IsWaterOfBuitenland := id(.) > 24[.];
	attribute<Bool> IsNatuur := id(.) == V/bos || id(.) == V/open_droog_natuurlijk_terrein || id(.) == V/open_nat_natuurlijk_terrein;
	attribute<Bool> IsLandbouw := id(.) == V/overig_agrarisch_terrein;
	attribute<Bool> IsGroen (.) := id(.) == V/Stedelijk_groen || id(.) == V/volkstuin || id(.) == V/Dagrecreatief_terrein || IsLandbouw || IsNatuur;
	attribute<Bool> IsGroen_breed (.) := IsNatuur || IsLandbouw || id(.) == V/Stedelijk_groen || id(.) == V/volkstuin;
	
	// attribute<Bool> IsWaterOfBuitenland := id(.) >= V/IJsselmeer_Markermeer;
	// attribute<Bool> IsLandWater := id(.) != V/buitenland;
	// attribute<Bool> IsWater := IsLandWater && IsWaterOfBuitenland;
	// attribute<Bool> IsLand  := IsLandWater && !IsWater;
	// attribute<Bool> IsNoordZeeWaddenRijnMaas := id(.) == V/Waddenzee_Eems_Dollard || id(.) == V/NoordZee || id(.) == V/Rijn_en_Maas;
	
	// attribute<Bool> IsGroen_intensief :=
		// id(.) == V/bos ||
		// id(.) == V/droog_natuurlijk_terrein ||
		// id(.) == V/nat_natuurlijk_terrein ||
		// id(.) == V/volkstuinen ||
		// id(.) == V/dagrecreatieve_terreinen;
		
	// attribute<Bool> IsGroen_ZeerIntensief :=
		// id(.) == V/Verblijfsrecreatie ||
		// id(.) == V/parken_en_plantsoenen ||
		// id(.) == V/sportterreinen ||
		// id(.) == V/begraafplaats;
		
	parameter<UInt32> nrAttr := 14;
	
		
		
	unit<UInt8> gg_10K: NrOfRows = 10
	{
		attribute<String> Label:    [
			'OSA_',
			'residential',
			'otherbuiltup',
			'construction',
			'infrastructure',
			'urbangreen',
			'agriculture',
			'nature',
			'water',
			'exteriorwater'];
		attribute<String> name := replace(Label, ' ', '_');
		
		container V := for_each_nedv(name, string(id(.))+'[..]', void, .);
	}
	
	unit<UInt8> gg_12K: NrOfRows = 12
	{
		attribute<String> Label:    [
		'OSA_', 
		'residential',
		'otherbuiltup',
		'construction',
		'infrastructure',
		'urbangreen',
		'greenhouses',
		'agriculture',
		'forest',
		'othernature',
		'water',
		'exteriorwater'],
		DialogType = "LabelText";
		attribute<String> name := replace(Label, ' ', '_');
		container V := for_each_nedv(name, string(id(.))+'[..]', void, .);
	}
	
	unit<UInt8> gg_12K_wo_OSA := select_with_org_rel(lowercase(gg_12K/name) != lowercase('OSA_'))
	{
		attribute<String> Label := gg_12K/Label[org_rel];
		attribute<String> name := gg_12K/name[org_rel];
		container V := for_each_nedv(name, string(id(.))+'[..]', void, .);
	}

	unit<UInt8> Aggr := unique(Aggr_ref)
	{
		attribute<String> name := values;
		attribute<String> Label := name, DialogType = "LabelText";
		attribute<UInt32> BrushColor:
		[
			rgb(128,129,150),
			rgb(245,255,217),
			rgb(0,179,89),
			rgb(255,235,215),
			rgb(121, 255,121),
			rgb(121, 255,121),
			rgb(121, 255,121),
			rgb(121, 255,121),
			rgb(121, 255,121),
			rgb(121, 255,121),
			rgb(183,183,255),
			rgb(213, 234,255),
			rgb(255,149,255),
			rgb(255,128,0),
			rgb(255,128,0),
			rgb(255,60,60)
		];

		attribute<Bool> IsGroen (.) :=
			id(.) == V/Begraafplaats ||
			id(.) == V/parken_en_plantsoenen ||
			id(.) == V/sportterreinen ||
			id(.) == V/volkstuinen ||
			id(.) == V/dagrecreatieve_terreinen ||
			id(.) == V/overige_agrarisch_gebruik ||
			id(.) == V/natuur;
			
		attribute<..> CBSKlasse_rel := invert(../Aggr_rel);
		attribute<Actor/Sector> Sector_rel := ../Sector_rel[CBSKlasse_rel];
		
		container V := for_each_nedv(name, string(id(.))+'[..]', void, .);
		
		unit<UInt8> Groen := select_with_org_rel(IsGroen)
		{
			attribute<String> name := Aggr/name[org_rel];
			attribute<String> Label := Aggr/Label[org_rel], DialogType = "LabelText";
			attribute<UInt32> BrushColor := Aggr/BrushColor[org_rel], DialogType = "BrushColor";
			attribute<CBSKlasse> CBSKlasse_rel := Aggr/CBSKlasse_rel[org_rel];
			
			container V := for_each_nedv(name, string(id(.))+'[..]', void, .);
		}
	}
	
	unit<UInt8> Aggr2 := unique(Aggr2_ref)
	{
		attribute<String> name := values;
		attribute<String> Label := name, DialogType = "LabelText";
		attribute<UInt32> BrushColor:
		[
			rgb(128,129,150),
			rgb(245,255,217),
			rgb(0,179,89),
			rgb(255,235,215),
			rgb(121, 255,121)
		];
		
		attribute<CBSKlasse> CBSKlasse_rel := invert(CBSKlasse/Aggr2_rel);
		attribute<Aggr> Aggr_rel := CBSKlasse/Aggr_rel[CBSKlasse_rel];
		
		container V := for_each_nedv(name, string(id(.))+'[..]', void, .);
	}
	
	// unit<UInt8> Aggr3 := unique(Aggr3_ref)
	// {
		// attribute<String> name := values;
		// attribute<String> Label := name, DialogType = "LabelText";
		// attribute<UInt32> BrushColor:
		// [
			// rgb(128,129,150),
			// rgb(245,255,217),
			// rgb(254, 50,0),
			// rgb(103,174,0),
			// rgb(128,128,128),
			// rgb(151,219,242)
		// ];
		
		// attribute<CBSKlasse> CBSKlasse_rel := invert(CBSKlasse/Aggr3_rel);
		
		// container V := for_each_nedv(name, string(id(.))+'[..]', void, .);
	// }
	
	// unit<UInt8> Aggr4 := unique(Aggr4_ref)
	// {
		// attribute<String> name := values;
		// attribute<String> Label := name, DialogType = "LabelText";
		// attribute<UInt32> BrushColor:
		// [
			// rgb(128,129,150),
			// rgb(245,255,217)
		// ];
		
		// attribute<CBSKlasse> CBSKlasse_rel := invert(CBSKlasse/Aggr4_rel);
		
		// container V := for_each_nedv(name, string(id(.))+'[..]', void, .);
	// }
	
	// unit<UInt8> Aggr5 := unique(Aggr5_ref)
	// {
		// attribute<String> name := values;
		// attribute<String> Label := name, DialogType = "LabelText";
		// attribute<UInt32> BrushColor:
		// [
			// rgb(128,129,150),
			// rgb(255,  0,220)
		// ];
		
		// attribute<CBSKlasse> CBSKlasse_rel := invert(CBSKlasse/Aggr5_rel);
		
		// container V := for_each_nedv(name, string(id(.))+'[..]', void, .);
	// }
	
	// unit<UInt8> Sector := unique(Sector_ref)
	// {
		// attribute<String> name := values;
		// attribute<String> Label := name, DialogType = "LabelText";
		// attribute<UInt32> BrushColor:
		// [
			// rgb(192,192,192),
			// rgb(102,  0,  0),
			// rgb(255,152,255),
			// rgb(255,  0,  0)
		// ];
		
		// attribute<CBSKlasse> CBSKlasse_rel := invert(CBSKlasse/Sector_rel2);
		// attribute<Classifications/TotaalLandgebruik> TL_rel : [3,2,1,0];

		// container V := for_each_nedv(name, string(id(.))+'[..]', void, .);
	// }

	
	container V := for_each_nedv(name, string(id(.))+'[..]', void, .);
}