////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Dit is RSOpen, de open source versie van het model RuimteScanner. Het scipt wordt uitgegeven onder GNU-GPL licentie.
//
// RSOpen is ontwikkeld door PBL Planbureau voor de Leefomgeving, i.s.m Object Vision B.V. en VU Vrije Universiteit Amsterdam.
// Opdrachtgever/ontwikkelaar PBL: Bart Rijken
// Contactpersoon/ontwikkelaar Object Vision B.V.: Jip Claassens (jclaassens@objectvision.nl)
// Contacpersoon PBL: Bas van Bemmel (Bas.vanBemmel@pbl.nl)
//
// Deze file specificeert de opties die virtuele projectontwikkelaars hebben t.a.v. de stedenbouwkiundige inrichting van gridcellen (AlocDomain) nieuw woongebied 
// Bron: expert judgement PBL
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

container BrutoBuurt
{
	unit<UInt8> Default_src := NettoBuurt/Default_src
	{
		attribute<Woning_ha>     Dichtheid                 := (NettoBuurt/Default_src/Dichtheid / BrutoTovNettoBuurt)[Woning_ha];
		attribute<Woonoppervlak> Woonoppervlakte           := (Dichtheid[float32] * Woonoppervlakte_woning[float32])[Woonoppervlak];
	}
	
	unit<UInt8> Default := Default_src
	{
		container InDezeBuurt := InBrutoBuurt;
	
		container InNettoBuurt
		{
			attribute<Terreinoppervlak> Terreinoppervlakte (Default) := (const(Ontwikkelpakketten/Terreinoppervlakte, Default) / BrutoTovNettoBuurt)[Terreinoppervlak]
			{
				attribute<Terreinoppervlak> Uitgeefbaar (Default) := . * Default/FractieUitgeefbaar
				{
					attribute<Terreinoppervlak> GebouwVoetafdruk (Default) := .. * Default/GroundSpaceIndex; // is per definitie de fractie voetafdruk van terreinopp nettobuurt; mag niet hoger zijn dan FractieUitgeefbaar
					attribute<Terreinoppervlak> Buitenruimte     (Default) := . - GebouwVoetafdruk
					{
						attribute<Terreinoppervlak> Verhard (Default) := . * InUitgeefbaarExPandFootprint/Verhard;
						attribute<Terreinoppervlak> Water   (Default) := . * InUitgeefbaarExPandFootprint/Water;
						attribute<Terreinoppervlak> Groen   (Default) := . * InUitgeefbaarExPandFootprint/Groen
						{
							attribute<Terreinoppervlak> Gras   (Default) := .. * InUitgeefbaarExPandFootprint/Gras;
							attribute<Terreinoppervlak> Boom   (Default) := .. * InUitgeefbaarExPandFootprint/Boom;
							attribute<Terreinoppervlak> Struik (Default) := .. * InUitgeefbaarExPandFootprint/Struik;
						}
					}
				}
				
				attribute<Terreinoppervlak> Openbaar (Default):= . * (1f - Default/FractieUitgeefbaar)
				{
					attribute<Terreinoppervlak> Verhard (Default) := . * InOpenbaar/Verhard;
					attribute<Terreinoppervlak> Water   (Default) := . * InOpenbaar/Water;
					attribute<Terreinoppervlak> Groen   (Default) := . * InOpenbaar/Groen
					{
						attribute<Terreinoppervlak> Gras   (Default) := .. * InOpenbaar/Gras;
						attribute<Terreinoppervlak> Boom   (Default) := .. * InOpenbaar/Boom;
						attribute<Terreinoppervlak> Struik (Default) := .. * InOpenbaar/Struik;
					}
				}
				
				attribute<Terreinoppervlak> Totaal (Default) := add(Uitgeefbaar, Openbaar)
				{
					attribute<Terreinoppervlak> GebouwVoetafdruk            (Default) := Uitgeefbaar/GebouwVoetafdruk; // is per definitie de fractie voetafdruk van terreinopp nettobuurt; mag niet hoger zijn dan FractieUitgeefbaar
					attribute<Terreinoppervlak> Verhard                     (Default) := add(Uitgeefbaar/Buitenruimte/Verhard, Openbaar/Verhard);
					attribute<Terreinoppervlak> GebouwVoetafdrukPlusVerhard (Default) := add(GebouwVoetafdruk, Verhard); // Deze gebruiken voor soil sealing
					
					attribute<Terreinoppervlak> Water (Default) := add(Uitgeefbaar/Buitenruimte/Water, Openbaar/Water);
					attribute<Terreinoppervlak> Groen (Default) := add(Uitgeefbaar/Buitenruimte/Groen, Openbaar/Groen)
					{
						attribute<Terreinoppervlak> Gras   (Default) := add(Uitgeefbaar/Buitenruimte/Groen/Gras, Openbaar/Groen/Gras);
						attribute<Terreinoppervlak> Boom   (Default) := add(Uitgeefbaar/Buitenruimte/Groen/Boom, Openbaar/Groen/Boom);
						attribute<Terreinoppervlak> Struik (Default) := add(Uitgeefbaar/Buitenruimte/Groen/Struik, Openbaar/Groen/Struik);
					}
				}
			}
		}
		
		container InTarraBuurt
		{
			container InOpenbaar
			{
				attribute<Float32> Verhard (Default) := const(VariantK/FractieVerhardInTarraBuurt[Variant_rel], Default);
				attribute<Float32> Water   (Default) := const(VariantK/FractieWaterInTarraBuurt[Variant_rel], Default);
				attribute<Float32> Groen   (Default) := const(VariantK/FractieGroenInTarraBuurt[Variant_rel], Default);
				attribute<Float32> Gras    (Default) := const(VariantK/FractieGrasInGroenInTarraBuurt[Variant_rel], Default);
				attribute<Float32> Boom    (Default) := const(VariantK/FractieBoomInGroenInTarraBuurt[Variant_rel], Default);
				attribute<Float32> Struik  (Default) := const(VariantK/FractieStruikInGroenInTarraBuurt[Variant_rel], Default);
			}
			
			attribute<Terreinoppervlak> Terreinoppervlakte (Default) := const(Ontwikkelpakketten/Terreinoppervlakte, Default) - InNettoBuurt/Terreinoppervlakte
			{
				attribute<Terreinoppervlak> Uitgeefbaar (Default) := const(0[Terreinoppervlak], Default)
				{
					attribute<Terreinoppervlak> GebouwVoetafdruk (Default) := const(0[Terreinoppervlak], Default);
					attribute<Terreinoppervlak> Buitenruimte     (Default) := const(0[Terreinoppervlak], Default)
					{
						attribute<Terreinoppervlak> Verhard (Default) := const(0[Terreinoppervlak], Default);
						attribute<Terreinoppervlak> Water   (Default) := const(0[Terreinoppervlak], Default);
						attribute<Terreinoppervlak> Groen   (Default) := const(0[Terreinoppervlak], Default)
						{
							attribute<Terreinoppervlak> Gras   (Default) := const(0[Terreinoppervlak], Default);
							attribute<Terreinoppervlak> Boom   (Default) := const(0[Terreinoppervlak], Default);
							attribute<Terreinoppervlak> Struik (Default) := const(0[Terreinoppervlak], Default);
						}
					}
				}
				
				attribute<Terreinoppervlak> Openbaar (Default):= . - Uitgeefbaar
				{
					attribute<Terreinoppervlak> Verhard (Default) := . * InOpenbaar/Verhard;
					attribute<Terreinoppervlak> Water   (Default) := . * InOpenbaar/Water;
					attribute<Terreinoppervlak> Groen   (Default) := . * InOpenbaar/Groen
					{
						attribute<Terreinoppervlak> Gras   (Default) := .. * InOpenbaar/Gras;
						attribute<Terreinoppervlak> Boom   (Default) := .. * InOpenbaar/Boom;
						attribute<Terreinoppervlak> Struik (Default) := .. * InOpenbaar/Struik;
					}
				}
				
				attribute<Terreinoppervlak> Totaal (Default) := add(Uitgeefbaar, Openbaar)
				{
					attribute<Terreinoppervlak> GebouwVoetafdruk            (Default) := Uitgeefbaar/GebouwVoetafdruk; // is per definitie de fractie voetafdruk van terreinopp nettobuurt; mag niet hoger zijn dan FractieUitgeefbaar
					attribute<Terreinoppervlak> Verhard                     (Default) := add(Uitgeefbaar/Buitenruimte/Verhard, Openbaar/Verhard);
					attribute<Terreinoppervlak> GebouwVoetafdrukPlusVerhard (Default) := add(GebouwVoetafdruk, Verhard); // Deze gebruiken voor soil sealing
					
					attribute<Terreinoppervlak> Water (Default) := add(Uitgeefbaar/Buitenruimte/Water, Openbaar/Water);
					attribute<Terreinoppervlak> Groen (Default) := add(Uitgeefbaar/Buitenruimte/Groen, Openbaar/Groen)
					{
						attribute<Terreinoppervlak> Gras   (Default) := add(Uitgeefbaar/Buitenruimte/Groen/Gras, Openbaar/Groen/Gras);
						attribute<Terreinoppervlak> Boom   (Default) := add(Uitgeefbaar/Buitenruimte/Groen/Boom, Openbaar/Groen/Boom);
						attribute<Terreinoppervlak> Struik (Default) := add(Uitgeefbaar/Buitenruimte/Groen/Struik, Openbaar/Groen/Struik);
					}
				}
			}
		}
		
		container InBrutoBuurt
		{
			attribute<Terreinoppervlak> Terreinoppervlakte (Default) := add(InNettoBuurt/Terreinoppervlakte, InTarraBuurt/Terreinoppervlakte)
			{
				attribute<Terreinoppervlak> Uitgeefbaar (Default) := add(InNettoBuurt/Terreinoppervlakte/Uitgeefbaar, InTarraBuurt/Terreinoppervlakte/Uitgeefbaar)
				{
					attribute<Terreinoppervlak> GebouwVoetafdruk (Default) := add(InNettoBuurt/Terreinoppervlakte/Uitgeefbaar/GebouwVoetafdruk, InTarraBuurt/Terreinoppervlakte/Uitgeefbaar/GebouwVoetafdruk);
					attribute<Terreinoppervlak> Buitenruimte     (Default) := add(InNettoBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte, InTarraBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte)
					{
						attribute<Terreinoppervlak> Verhard (Default) := add(InNettoBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Verhard, InTarraBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Verhard);
						attribute<Terreinoppervlak> Water   (Default) := add(InNettoBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Water, InTarraBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Water);
						attribute<Terreinoppervlak> Groen   (Default) := add(InNettoBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen, InTarraBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen)
						{
							attribute<Terreinoppervlak> Gras   (Default) := add(InNettoBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen/Gras, InTarraBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen/Gras);
							attribute<Terreinoppervlak> Boom   (Default) := add(InNettoBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen/Boom, InTarraBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen/Boom);
							attribute<Terreinoppervlak> Struik (Default) := add(InNettoBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen/Struik, InTarraBuurt/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen/Struik);
						}
					}
				}
				
				attribute<Terreinoppervlak> Openbaar (Default) := add(InNettoBuurt/Terreinoppervlakte/Openbaar, InTarraBuurt/Terreinoppervlakte/Openbaar)
				{
					attribute<Terreinoppervlak> Verhard (Default) := add(InNettoBuurt/Terreinoppervlakte/Openbaar/Verhard, InTarraBuurt/Terreinoppervlakte/Openbaar/Verhard);
					attribute<Terreinoppervlak> Water   (Default) := add(InNettoBuurt/Terreinoppervlakte/Openbaar/Water, InTarraBuurt/Terreinoppervlakte/Openbaar/Water);
					attribute<Terreinoppervlak> Groen   (Default) := add(InNettoBuurt/Terreinoppervlakte/Openbaar/Groen, InTarraBuurt/Terreinoppervlakte/Openbaar/Groen)
					{
						attribute<Terreinoppervlak> Gras   (Default) := add(InNettoBuurt/Terreinoppervlakte/Openbaar/Groen/Gras, InTarraBuurt/Terreinoppervlakte/Openbaar/Groen/Gras);
						attribute<Terreinoppervlak> Boom   (Default) := add(InNettoBuurt/Terreinoppervlakte/Openbaar/Groen/Boom, InTarraBuurt/Terreinoppervlakte/Openbaar/Groen/Boom);
						attribute<Terreinoppervlak> Struik (Default) := add(InNettoBuurt/Terreinoppervlakte/Openbaar/Groen/Struik, InTarraBuurt/Terreinoppervlakte/Openbaar/Groen/Struik);
					}
				}
				
				attribute<Terreinoppervlak> Totaal (Default) := add(InNettoBuurt/Terreinoppervlakte/Totaal, InTarraBuurt/Terreinoppervlakte/Totaal)
				{
					attribute<Terreinoppervlak> GebouwVoetafdruk            (Default) := add(InNettoBuurt/Terreinoppervlakte/Totaal/GebouwVoetafdruk, InTarraBuurt/Terreinoppervlakte/Totaal/GebouwVoetafdruk);
					attribute<Terreinoppervlak> Verhard                     (Default) := add(InNettoBuurt/Terreinoppervlakte/Totaal/Verhard, InTarraBuurt/Terreinoppervlakte/Totaal/Verhard);
					attribute<Terreinoppervlak> GebouwVoetafdrukPlusVerhard (Default) := add(InNettoBuurt/Terreinoppervlakte/Totaal/GebouwVoetafdrukPlusVerhard, InTarraBuurt/Terreinoppervlakte/Totaal/GebouwVoetafdrukPlusVerhard);
					
					attribute<Terreinoppervlak> Water (Default) := add(InNettoBuurt/Terreinoppervlakte/Totaal/Water, InTarraBuurt/Terreinoppervlakte/Totaal/Water);
					attribute<Terreinoppervlak> Groen (Default) := add(InNettoBuurt/Terreinoppervlakte/Totaal/Groen, InTarraBuurt/Terreinoppervlakte/Totaal/Groen)
					{
						attribute<Terreinoppervlak> Gras   (Default) := add(InNettoBuurt/Terreinoppervlakte/Totaal/Groen/Gras, InTarraBuurt/Terreinoppervlakte/Totaal/Groen/Gras);
						attribute<Terreinoppervlak> Boom   (Default) := add(InNettoBuurt/Terreinoppervlakte/Totaal/Groen/Boom, InTarraBuurt/Terreinoppervlakte/Totaal/Groen/Boom);
						attribute<Terreinoppervlak> Struik (Default) := add(InNettoBuurt/Terreinoppervlakte/Totaal/Groen/Struik, InTarraBuurt/Terreinoppervlakte/Totaal/Groen/Struik);
					}
				}
			}
			
			container PerWoning
			{
				container Src := InBrutoBuurt;
				
				attribute<m2_Woning> Terreinoppervlakte (Default) := Src/Terreinoppervlakte[meter2] / (Default/DichtheidBrutoBuurt * 1[ha])
				{
					attribute<m2_Woning> Uitgeefbaar (Default) := Src/Terreinoppervlakte/Uitgeefbaar[meter2] / (Default/DichtheidBrutoBuurt * 1[ha])
					{
						attribute<m2_Woning> GebouwVoetafdruk (Default) := Src/Terreinoppervlakte/Uitgeefbaar/GebouwVoetafdruk[meter2] / (Default/DichtheidBrutoBuurt * 1[ha]);
						attribute<m2_Woning> Buitenruimte     (Default) := Src/Terreinoppervlakte/Uitgeefbaar/Buitenruimte[meter2]     / (Default/DichtheidBrutoBuurt * 1[ha])
						{
							attribute<m2_Woning> Verhard (Default) := Src/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Verhard[meter2] / (Default/DichtheidBrutoBuurt * 1[ha]);
							attribute<m2_Woning> Water   (Default) := Src/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Water[meter2]   / (Default/DichtheidBrutoBuurt * 1[ha]);
							attribute<m2_Woning> Groen   (Default) := Src/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen[meter2]   / (Default/DichtheidBrutoBuurt * 1[ha])
							{
								attribute<m2_Woning> Gras   (Default) := Src/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen/Gras[meter2]   / (Default/DichtheidBrutoBuurt * 1[ha]);
								attribute<m2_Woning> Boom   (Default) := Src/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen/Boom[meter2]   / (Default/DichtheidBrutoBuurt * 1[ha]);
								attribute<m2_Woning> Struik (Default) := Src/Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen/Struik[meter2] / (Default/DichtheidBrutoBuurt * 1[ha]);
							}
						}
					}
					
					attribute<m2_Woning> Openbaar (Default) := Src/Terreinoppervlakte/Openbaar[meter2] / (Default/DichtheidBrutoBuurt * 1[ha])
					{
						attribute<m2_Woning> Verhard (Default) := Src/Terreinoppervlakte/Openbaar/Verhard[meter2] / (Default/DichtheidBrutoBuurt * 1[ha]);
						attribute<m2_Woning> Water   (Default) := Src/Terreinoppervlakte/Openbaar/Water[meter2]   / (Default/DichtheidBrutoBuurt * 1[ha]);
						attribute<m2_Woning> Groen   (Default) := Src/Terreinoppervlakte/Openbaar/Groen[meter2]   / (Default/DichtheidBrutoBuurt * 1[ha])
						{
							attribute<m2_Woning> Gras   (Default) := Src/Terreinoppervlakte/Openbaar/Groen/Gras[meter2]   / (Default/DichtheidBrutoBuurt * 1[ha]);
							attribute<m2_Woning> Boom   (Default) := Src/Terreinoppervlakte/Openbaar/Groen/Boom[meter2]   / (Default/DichtheidBrutoBuurt * 1[ha]);
							attribute<m2_Woning> Struik (Default) := Src/Terreinoppervlakte/Openbaar/Groen/Struik[meter2] / (Default/DichtheidBrutoBuurt * 1[ha]);
						}
					}
					
					attribute<m2_Woning> Totaal (Default) := Src/Terreinoppervlakte/Totaal[meter2] / (Default/DichtheidBrutoBuurt * 1[ha])
					{
						attribute<m2_Woning> GebouwVoetafdruk            (Default) := Src/Terreinoppervlakte/Totaal/GebouwVoetafdruk[meter2]            / (Default/DichtheidBrutoBuurt * 1[ha]);
						attribute<m2_Woning> Verhard                     (Default) := Src/Terreinoppervlakte/Totaal/Verhard[meter2]                     / (Default/DichtheidBrutoBuurt * 1[ha]);
						attribute<m2_Woning> GebouwVoetafdrukPlusVerhard (Default) := Src/Terreinoppervlakte/Totaal/GebouwVoetafdrukPlusVerhard[meter2] / (Default/DichtheidBrutoBuurt * 1[ha]);
						
						attribute<m2_Woning> Water (Default) := Src/Terreinoppervlakte/Totaal/Water[meter2] / (Default/DichtheidBrutoBuurt * 1[ha]);
						attribute<m2_Woning> Groen (Default) := Src/Terreinoppervlakte/Totaal/Groen[meter2] / (Default/DichtheidBrutoBuurt * 1[ha])
						{
							attribute<m2_Woning> Gras   (Default) := Src/Terreinoppervlakte/Totaal/Groen/Gras[meter2]   / (Default/DichtheidBrutoBuurt * 1[ha]);
							attribute<m2_Woning> Boom   (Default) := Src/Terreinoppervlakte/Totaal/Groen/Boom[meter2]   / (Default/DichtheidBrutoBuurt * 1[ha]);
							attribute<m2_Woning> Struik (Default) := Src/Terreinoppervlakte/Totaal/Groen/Struik[meter2] / (Default/DichtheidBrutoBuurt * 1[ha]);
						}
					}
				}
			}
			
			container FractiesGroen // tov Terreinoppervlakt
			{
				attribute<Float32> Gras   (Default) := div(add(Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen/Gras,   Terreinoppervlakte/Openbaar/Groen/Gras),   Terreinoppervlakte);
				attribute<Float32> Boom   (Default) := div(add(Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen/Boom,   Terreinoppervlakte/Openbaar/Groen/Boom),   Terreinoppervlakte);
				attribute<Float32> Struik (Default) := div(add(Terreinoppervlakte/Uitgeefbaar/Buitenruimte/Groen/Struik, Terreinoppervlakte/Openbaar/Groen/Struik), Terreinoppervlakte);
				
				attribute<Float32> Totaal (Default) := add(Gras, Boom, Struik);
			}
			
			attribute<Perceeloppervlak>        PerceeloppervlakteTotaal (Default) := Terreinoppervlakte/Uitgeefbaar[Perceeloppervlak], Descr = "De totale perceeloppervlakte in m2, inclusief de footprint van de woning en het aandeel van de buitenruimte dat bij de woning hoort"; //Nog in template stoppen. Wordt nu twee keer berekend op zelfde manier, voor netto en bruto buurt
			attribute<Perceeloppervlak_Woning> Perceeloppervlakte       (Default) := PerceeloppervlakteTotaal / (Default/Dichtheid * 1[ha])[Woning], Descr = "De totale perceeloppervlakte per woning in m2, inclusief de footprint van de woning en het aandeel van de buitenruimte dat bij de woning hoort"; //Nog in template stoppen. Wordt nu twee keer berekend op zelfde manier, voor netto en bruto buurt
	
			attribute<m2_Woning>               Tuinoppervlakte          (Default) := Terreinoppervlakte/Uitgeefbaar/Buitenruimte / (Default/Dichtheid * 1[ha])[Woning], Descr = "De tuinoppervlakte per woning in m2, dus exclusief de footprint van de woning.";
		}
	}
}